<div class="all-page h-100">
  <div class="all-card">
    <div class="card-head df">
      <div class="mr-2">{{issue.name}}</div>
      <div class="mr-2">{{issue.doc_number}}</div>
      <div class="mr-2">rev{{issue.revision}}</div>
      <div class="p-ml-auto mr-10 df">
        <div class="df all-tabs-button mr-2" *ngIf="cablesSource.length != 0">
          <div class="tabs-button-cable cursor-pointer cxy" (click)="selectedTab = 'Cables'"
               [class.selected-tab]="selectedTab == 'Cables'">Cables
          </div>
          <div class="tabs-button-equip cursor-pointer cxy" (click)="selectedTab = 'Equipment'"
               [class.selected-tab]="selectedTab == 'Equipment'">Equipment
          </div>
        </div>
        <span class="p-input-icon-left p-ml-auto">
            <i class="pi pi-search"></i>
            <input [(ngModel)]="searchPlates" (ngModelChange)="searchChanged()" pInputText type="text"
                   [placeholder]="l.tr('Поиск...')" class="border width-170"/>
          </span>
      </div>
    </div>
    <div [hidden]="selectedTab != 'Cables'">
      <div class="w-100 df">
        <div class="card-sp-tile mr-20">
          <div class="loading-text" *ngIf="noResultCables">No result for drawing {{docNumber}} of
            project {{project}}. You need
            to add document number {{docNumber}} to the system description using FORAN app in {{project}} project
          </div>
          <div *ngIf="cablesSource.length == 0 && !noResultCables">
            <div class="cxy loading">
              <div class="cxy card-height">
                <img src="assets/whale.gif" height="120">
                <div class="cx loading-text">PLEASE WAIT...</div>
              </div>
            </div>
          </div>
          <div *ngIf="cables.length == 0 && cablesSource.length != 0">
            <div class="cxy loading">
              <div class="cxy card-height">
                <div class="cx loading-text">NO SEARCH RESULTS</div>
              </div>
            </div>
          </div>
          <div *ngIf="selectedView == 'tiles'">
            <div class="tile">
              <div class="w-100" *ngIf="cablesSource.length != 0">
                <p-virtualScroller [value]="cables" scrollHeight="calc(100vh - 197px)" [itemSize]="220">

                  <ng-template pTemplate="cable" let-cable let-i="index">
                    <div class="card-tile-t w-100"
                         [class.hidden-card]="cable == null">
                      <div class="top-row df">
                        <div [ngSwitch]="cable.f_rout" class="cxy mr-1">
                          <div *ngSwitchCase="0" class="point red-point" pTooltip="{{l.tr('Не проложен')}}"
                               tooltipPosition="top"></div>
                          <div *ngSwitchCase="1" class="point green-point" pTooltip="{{l.tr('Проложен')}}"
                               tooltipPosition="top"></div>
                          <div *ngSwitchCase="2" class="point yellow-point" pTooltip="{{l.tr('Проложен частично')}}"
                               tooltipPosition="top"></div>
                        </div>
                        <div class="cxy mr-1" *ngIf="cable.bunch != ''" pTooltip="{{l.tr('Пучковая прокладка')}}"
                             tooltipPosition="top">
                          <img src="assets/icons/hub.png" height="18">
                        </div>
                        <div class="cxy mr-2">
                          <div class="title-medium-bold">{{cable.code}}</div>
                        </div>
                        <div class="cxy mr-2">
                          <div class=title-name>{{cable.description}}</div>
                        </div>
                        <div class="df cxy mr-1">
                          <div class="text-center-y attribute mr-10 title-name">Sec:</div>
                          <div class="title-name">{{cable.nom_section}}</div>
                        </div>
                        <div class="df cxy mr-1">
                          <div class="text-center-y attribute mr-10 title-name">D:</div>
                          <div class="title-name">{{cable.diameter}}</div>
                        </div>
                        <div class="df cxy mr-1">
                          <div class="text-center-y attribute mr-10 title-name">Seg:</div>
                          <div class="title-name">{{cable.seg_code}}</div>
                        </div>
                        <div class="df cxy mr-1">
                          <div class="text-center-y attribute mr-10 title-name">L:</div>
                          <div class="title-name">{{round(cable.length) + 'm'}}</div>
                          <div
                            class="text-center-y attribute mr-10 title-name" pTooltip="{{l.tr('Поправка длины')}}"
                            tooltipPosition="right">
                            {{' (' + cable.ext_len_1 + '-' + cable.ext_len_2 + ')'}}</div>
                        </div>
                        <div class="p-ml-auto text-center-y">
                          <div class="df">
                            <div class="trm">{{cable.stock_code}}</div>
                            <div (click)="copyTrmCode(cable.stock_code, 'c' + i)" class="trm-copy cursor-pointer cxy">
                              <img src="assets/icons/trm.svg" height="16">
                              <div class="copy-tooltip" [hidden]="!showTooltip('c' + i)">Copied!</div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="route mb-5">
                        <!--                        <div  *ngIf="cable.cab_route_area.length != 0">-->
                        <!--                          {{cable.cab_route_area.join('<->')}}-->
                        <!--                        </div>-->
                        <!--                        <div class="df space-between" *ngIf="cable.cab_route_area.length != 0">-->
                        <!--                          <div *ngFor="let node of cable.cab_route_area; let e = index"-->
                        <!--                               [class.hidden-card]="node == null">-->
                        <!--                            <div class="node gray-point" pTooltip="{{node}}"-->
                        <!--                                 tooltipPosition="top"></div>-->
                        <!--                          </div>-->
                        <!--                        </div>-->
                        <div class="df nodeRoute" *ngIf="cable.cab_route_area.length != 0">
                          {{cable.cab_route_area.join('<->')}}
                        </div>
                      </div>
                      <div class="bottom-grid mr-1">

                        <div class="hover-row cursor-pointer" (click)="onClickFromEquipment(cable)">
                          <div class="mb-5 equip-style">
                            <div class="df flex-end">
                              <div class="attribute text-table-col flex-end mr-10"
                                   *ngIf="cable.from_eq_desc != ''">{{cable.from_eq_desc}}</div>
                              <div class="attribute mr-10 text-table-col" *ngIf="cable.from_eq_id != ''">
                                ({{cable.from_eq_id}})
                              </div>
                              <div class="title-name flex-end" *ngIf="cable.from_eq != ''">{{cable.from_eq}}</div>
                            </div>
                          </div>
                          <div class="mb-5 zone-style df flex-end">
                            <div class="attribute text-table-col mr-10"
                                 *ngIf="cable.from_zone_desc != ''">{{cable.from_zone_desc}}</div>
                            <div class="title-name"
                                 *ngIf="cable.from_zone != ''">{{cable.from_zone}}</div>
                          </div>
                          <div class="flex-end system-style">
                            <div
                              class="title-name" *ngIf="cable.from_system != ''"
                              pTooltip="{{cable.from_system.split(' ').splice(1).join(' ')}}"
                              tooltipPosition="left">
                              {{cable.from_system.split(' ')[0].replace('.', '')}}
                            </div>
                          </div>
                        </div>
                        <div>
                          <div class="df coordinates-row cxy mb-1r">
                            <span class="mm-text flex-end">{{' ' + round(cable.from_x)}}</span>
                            <div class="coordinates-x cxy mr-5 ml-5">X</div>
                            <span class="mm-text flex-start">{{' ' + round(cable.to_x)}}</span>
                          </div>
                          <div class="df coordinates-row cxy mb-1r">
                            <span class="mm-text flex-end">{{' ' + round(cable.from_y)}}</span>
                            <div class="coordinates-y cxy mr-5 ml-5">Y</div>
                            <span class="mm-text flex-start">{{' ' + round(cable.to_y)}}</span>
                          </div>
                          <div class="df coordinates-row cxy mb-1r">
                            <span class="mm-text flex-end">{{' ' + round(cable.from_z)}}</span>
                            <div class="coordinates-z cxy mr-5 ml-5">Z</div>
                            <span class="mm-text flex-start">{{' ' + round(cable.to_z)}}</span>
                          </div>
                        </div>
                        <div class="cursor-pointer hover-row" (click)="onClickToEquipment(cable)">
                          <div class="mb-5 equip-style">
                            <div class="df">
                              <div class="title-name mr-10" *ngIf="cable.to_eq != ''">{{cable.to_eq}}</div>
                              <div class="attribute text-table-col mr-10" *ngIf="cable.to_eq_id != ''">
                                ({{cable.to_eq_id}})
                              </div>
                              <div class="attribute text-table-col"
                                   *ngIf="cable.to_eq_desc != ''">{{cable.to_eq_desc}}</div>
                            </div>
                          </div>
                          <div class="mb-5 zone-style df ">
                            <div class="title-name mr-10" *ngIf="cable.to_zone != ''">{{cable.to_zone}}</div>
                            <div class="attribute text-table-col "
                                 *ngIf="cable.to_zone_desc != ''">{{cable.to_zone_desc}}</div>
                          </div>
                          <div *ngIf="cable.to_system != ''" class="system-style">
                            <div class="flex-start">
                              <div
                                class="title-name"
                                pTooltip="{{cable.to_system.split(' ').splice(1).join(' ')}}"
                                tooltipPosition="right">
                                {{cable.to_system.split(' ')[0].replace('.', '')}}
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </ng-template>
                </p-virtualScroller>
              </div>
            </div>
          </div>
        </div>
        <div class="w-32 right-content-card mt-20">
          <div class="df tabs-header">
            <div class="all-tabs cursor-pointer" (click)="selectedHeadTab = 'Files'"
                 [class.selectedTab]="selectedHeadTab ==  'Files'">{{l.tr('Файлы')}}</div>
            <div class="all-tabs cursor-pointer" (click)="selectedHeadTab = 'Misc'"
                 [class.selectedTab]="selectedHeadTab ==  'Misc'">{{l.tr('Задачи')}}</div>
            <div class="all-tabs cursor-pointer" (click)="selectedHeadTab = 'Archive'"
                 [class.selectedTab]="selectedHeadTab ==  'Archive'">{{l.tr('Архив')}}</div>
          </div>

          <div *ngIf="selectedHeadTab == 'Files'" class="card-tabs">
            <div class="mb-30" *ngFor="let fileGroup of fileGroups"
                 [class.hidden-group]="!auth.hasPerms('esp-files') && fileGroup.need_rights">
              <p-fieldset legend="{{fileGroup.name}}" [toggleable]="true"
                          [collapsed]="getRevisionFilesOfGroup(fileGroup.name, selectedRevision).length == 0 || fileGroup.collapsed">
                <div>
                  <div class="df">
                    <div *ngIf="'Electric' == auth.getUser().department && issue.status == 'Delivered'"
                         class="button-details df cursor-pointer mb-15"
                         (click)="addFilesToGroup(fileGroup.name, selectedRevision)">
                      <div class="cxy">
                        <img src="assets/icons/plus1.svg" height="16">
                      </div>
                      <div class="cy ml-1">Add files</div>
                    </div>
                    <div *ngIf="fileGroup.name != 'Cutting Map'" class="ml-1 button-details df cursor-pointer mb-15"
                         (click)="downloadFiles(fileGroup.name, selectedRevision)">
                      <div class="cxy">
                        <img src="assets/icons/download-arrow.png">
                      </div>
                      <div class="cy ml-1">Download all</div>
                    </div>


                    <div *ngIf="fileGroup.name == 'Cutting Map'">
                      <div class="ml-1 button-details df cursor-pointer mb-15"
                           (click)="$event.ctrlKey ? downloadFilesCVC(fileGroup.name, selectedRevision, 'txt') : download.toggle($event)">
                        <div class="cxy">
                          <img src="assets/icons/download-arrow.png">
                        </div>
                        <div class="cy ml-1">Download all</div>
                      </div>
                      <p-overlayPanel #download [style]="{width: '50px', 'border-radius': '4px', 'z-index': 11}">
                        <ng-template pTemplate>
                          <div class="df border-bottom all-row-user-menu cursor-pointer"
                               (click)="downloadFiles(fileGroup.name, selectedRevision, 'cnc')">
                            <div class="row-download">.MPG</div>
                          </div>
                          <div class="df all-row-user-menu cursor-pointer"
                               (click)="downloadFiles(fileGroup.name, selectedRevision, 'essi')">
                            <div class="row-download">.ESI</div>
                          </div>
                          <div class="df all-row-user-menu cursor-pointer"
                               (click)="downloadFiles(fileGroup.name, selectedRevision, 'tap')">
                            <div class="row-download">.TAP</div>
                          </div>
                        </ng-template>
                      </p-overlayPanel>
                    </div>


                    <div *ngIf="'Electric' == auth.getUser().department"
                         [class.disabled-button]="getRevisionFilesOfGroup(fileGroup.name, selectedRevision).length == 0"
                         class="ml-1 button-details df cursor-pointer mb-15"
                         (click)="clearFiles(fileGroup.name, selectedRevision)">
                      <div class="cxy icon-rotate">
                        <img src="assets/icons/broom.png">
                      </div>
                      <div class="cy ml-1">Clear</div>
                    </div>
                  </div>
                  <div class="" *ngIf="getRevisionFilesOfGroup(fileGroup.name, selectedRevision).length != 0">
                    <div class="attachment-files df mb-6">
                      <div></div>
                      <div class="cy mx-10 cursor-pointer" (click)="setFileSort('name')">
                        <img [class.files-sorted]="fileSort == 'name'" src="assets/icons/sort.svg" height="16">
                      </div>
                      <div class="cy cursor-pointer" [class.files-sorted]="fileSort == 'date'"
                           (click)="setFileSort('date')">
                        <img src="assets/icons/sort.svg" height="16">
                      </div>
                      <div></div>
                      <div></div>
                      <div></div>
                    </div>
                    <div *ngFor="let file of getRevisionFilesOfGroup(fileGroup.name, selectedRevision)">

                      <div class="attachment-files df mb-6 cursor-pointer">
                        <div class="cxy">
                          <img [src]="'assets/task/' + getFileExtensionIcon(file.name)" height="25"/>
                        </div>
                        <span class="file-name-esp mx-10 cy">{{trimFileName(file.name, 22) + ' '}}</span>
                        <span class="cy">{{' ' + getDate(file.upload_date)}}</span>


                        <div class="cxy" *ngIf="file.name.includes('.dxf')">
                          <div [pTooltip]="l.tr('Show In Viewer')" tooltipPosition="top" class=" cxy"
                               (click)="showDxfInViewer(file.url); $event.stopPropagation()">
                            <svg class="icon-nest" width="20" height="20" viewBox="0 0 20 20" fill="none"
                                 xmlns="http://www.w3.org/2000/svg">
                              <path
                                d="M3.25909 11.6021C3.94254 8.32689 6.79437 6 10 6C13.2057 6 16.0574 8.32688 16.7409 11.6021C16.7974 11.8725 17.0622 12.0459 17.3325 11.9895C17.6029 11.933 17.7763 11.6682 17.7199 11.3979C16.9425 7.67312 13.6934 5 10 5C6.3066 5 3.05742 7.67311 2.28017 11.3979C2.22377 11.6682 2.39718 11.933 2.6675 11.9895C2.93782 12.0459 3.20268 11.8725 3.25909 11.6021Z"/>
                              <path
                                d="M9.98953 8C11.9225 8 13.4895 9.567 13.4895 11.5C13.4895 13.433 11.9225 15 9.98953 15C8.05653 15 6.48953 13.433 6.48953 11.5C6.48953 9.567 8.05653 8 9.98953 8Z"/>
                            </svg>
                          </div>
                        </div>
                        <div *ngIf="file.group == 'Cutting Map'" [pTooltip]="l.tr('Show Cutting Map')"
                             (click)="showCuttingFile(file)" tooltipPosition="top" class="cxy">
                          <svg class="icon-nest" width="20" height="20" viewBox="0 0 20 20" fill="none"
                               xmlns="http://www.w3.org/2000/svg">
                            <path
                              d="M3.25909 11.6021C3.94254 8.32689 6.79437 6 10 6C13.2057 6 16.0574 8.32688 16.7409 11.6021C16.7974 11.8725 17.0622 12.0459 17.3325 11.9895C17.6029 11.933 17.7763 11.6682 17.7199 11.3979C16.9425 7.67312 13.6934 5 10 5C6.3066 5 3.05742 7.67311 2.28017 11.3979C2.22377 11.6682 2.39718 11.933 2.6675 11.9895C2.93782 12.0459 3.20268 11.8725 3.25909 11.6021Z"/>
                            <path
                              d="M9.98953 8C11.9225 8 13.4895 9.567 13.4895 11.5C13.4895 13.433 11.9225 15 9.98953 15C8.05653 15 6.48953 13.433 6.48953 11.5C6.48953 9.567 8.05653 8 9.98953 8Z"/>
                          </svg>
                        </div>
                        <div class="cxy" *ngIf="!file.name.includes('.dxf') && file.group != 'Cutting Map'"></div>

                        <div *ngIf="file.group != 'Cutting Map'" class="cxy" (click)="openFile(file)">
                          <svg class="icon-nest" xmlns="http://www.w3.org/2000/svg" width="20" height="20"
                               viewBox="0 0 24 24">
                            <path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/>
                          </svg>
                        </div>

                        <div class="cxy" *ngIf="file.group == 'Cutting Map'">
                          <div class="cxy" (click)="download.toggle($event)">
                            <svg class="icon-nest" xmlns="http://www.w3.org/2000/svg" width="20" height="20"
                                 viewBox="0 0 24 24">
                              <path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/>
                            </svg>
                          </div>
                          <p-overlayPanel #download [style]="{width: '50px', 'border-radius': '4px', 'z-index': 11}">
                            <ng-template pTemplate>
                              <div class="df border-bottom all-row-user-menu cursor-pointer" (click)="openFile(file)">
                                <div class="row-download">.MPG</div>
                              </div>
                              <div class="df all-row-user-menu cursor-pointer" (click)="openFile(file, 'essi')">
                                <div class="row-download">.ESI</div>
                              </div>
                              <div class="df all-row-user-menu cursor-pointer" (click)="openFile(file, 'tap')">
                                <div class="row-download">.TAP</div>
                              </div>
                            </ng-template>
                          </p-overlayPanel>
                        </div>
                        <div class="cxy" *ngIf="'Electric' == auth.getUser().department" (click)="deleteFile(file.url)">
                          <svg class="icon-nest" xmlns="http://www.w3.org/2000/svg" width="22" height="22"
                               viewBox="0 0 24 24">
                            <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
                          </svg>
                        </div>
                      </div>
                    </div>
                  </div>
                  <!--                <div class="df right-top-revision">-->
                  <!--                  <div class="pt-5">View files of revision</div>-->
                  <!--                  <div class="ml-1">-->
                  <!--                    <p-dropdown appendTo="body" [(ngModel)]="selectedRevision" [options]="issueRevisions" (ngModelChange)="viewRevisionChanged()" styleClass="w-100 h-32 cxy">-->
                  <!--                    </p-dropdown>-->
                  <!--                  </div>-->
                  <!--                </div>-->
                </div>
              </p-fieldset>
            </div>

          </div>
          <div *ngIf="selectedHeadTab == 'Misc'" class="card-tabs">
            <div class="subtask-grid-misc py-10">
              <div class="head-subtask">{{l.tr('Тип')}}</div>
              <div class="head-subtask">{{l.tr('Название')}}</div>
              <div class="head-subtask">{{l.tr('Отв.')}}</div>
              <div class="head-subtask">{{l.tr('Исп.')}}</div>
              <div class="head-subtask">{{l.tr('Статус')}}</div>
            </div>
            <div class="">
              <div class="subtask" *ngFor="let childIssue of miscIssues">
                <div class="subtask-grid-misc" (click)="openIssue(childIssue.id)">
                  <div class="cy px-10 py-10 subtask-text" [innerHTML]="childIssue.issue_type"></div>
                  <div class="py-10 px-10 subtask-text">
                    <span>{{childIssue.doc_number + ' '}}</span>
                    <span [innerHTML]="issueManager.trim(childIssue.name)"></span>
                  </div>
                  <div class="cy px-10 py-10 subtask-text"
                       [innerHTML]="issueManager.getAssignedToTrim(childIssue.responsible)"></div>
                  <div class="cy px-10 py-10 subtask-text"
                       [innerHTML]="issueManager.getAssignedToTrim(childIssue.assigned_to)"></div>
                  <div class="dfc px-10 py-10 subtask-text"
                       [innerHTML]="issueManager.localeStatus(childIssue.status) | safeHtml"></div>
                </div>
              </div>
            </div>
          </div>
          <div *ngIf="selectedHeadTab == 'Archive'" class="card-tabs">
            <div *ngFor="let file of getArchive()">
              <div class="attachment-files-archive df mb-6 cursor-pointer">
                <div class="cxy">
                  <img [src]="'assets/task/' + getFileExtensionIcon(file.name)" height="25"/>
                </div>
                <span class="file-name-esp mx-10 min-width-150 cy">{{trimFileName(file.name, 30) + ' '}}</span>
                <span
                  class="cy pl-5">{{this.auth.getUserTrimName(file.removed_by) + ' ' + getDate(file.removed_date)}}</span>
                <div class="cxy ml-10 load-cloud" *ngIf="file.name.includes('.dxf')">
                  <div [pTooltip]="l.tr('Show In Viewer')" tooltipPosition="top" class=""
                       (click)="showDxfInViewer(file.url); $event.stopPropagation()">
                    <svg class="icon-nest" width="20" height="20" viewBox="0 0 20 20" fill="none"
                         xmlns="http://www.w3.org/2000/svg">
                      <path
                        d="M3.25909 11.6021C3.94254 8.32689 6.79437 6 10 6C13.2057 6 16.0574 8.32688 16.7409 11.6021C16.7974 11.8725 17.0622 12.0459 17.3325 11.9895C17.6029 11.933 17.7763 11.6682 17.7199 11.3979C16.9425 7.67312 13.6934 5 10 5C6.3066 5 3.05742 7.67311 2.28017 11.3979C2.22377 11.6682 2.39718 11.933 2.6675 11.9895C2.93782 12.0459 3.20268 11.8725 3.25909 11.6021Z"/>
                      <path
                        d="M9.98953 8C11.9225 8 13.4895 9.567 13.4895 11.5C13.4895 13.433 11.9225 15 9.98953 15C8.05653 15 6.48953 13.433 6.48953 11.5C6.48953 9.567 8.05653 8 9.98953 8Z"/>
                    </svg>
                  </div>
                </div>
                <div class="cxy ml-10 load-cloud" *ngIf="!file.name.includes('.dxf')">
                </div>
                <div class="cxy ml-10" (click)="openFile(file)">
                  <svg class="icon-nest" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24">
                    <path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/>
                  </svg>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div [hidden]="selectedTab != 'Equipment'">
      <div class="w-100 df">
        <div class="card-eq-tile mr-20">
          <div class="loading-text" *ngIf="noResultCables">No result for drawing {{docNumber}} of
            project {{project}}. You need
            to add document number {{docNumber}} to the system description using FORAN app in {{project}} project
          </div>
          <div *ngIf="cablesSource.length == 0 && !noResultCables">
            <div class="cxy loading">
              <div class="cxy card-height">
                <img src="assets/whale.gif" height="120">
                <div class="cx loading-text">PLEASE WAIT...</div>
              </div>
            </div>
          </div>
          <div>
            <div class="tile">
              <div class="w-100 " *ngIf="cablesSource.length != 0">
              </div>
              <div class="w-100" *ngIf="equipmentsSource.length != 0">
                <div *ngFor="let eq of equipments; let e = index"
                     [class.hidden-card]="eq == null">
                  <div id="{{e}}" class="card-tile-eq card-grid-eq"
                       (click)="onSelectEquipment(eq)"
                       [class.selected-eq]="selectedEq == eq">
                    <div class="text-center-y df cursor-pointer">
                      <div class="title-name mr-10">{{eq.name}}</div>
                      <div class="text-center-y attribute mr-10 text-table-col">{{eq.id}}</div>
                      <div class="text-center-y attribute mr-10 text-table-col">{{eq.desc}}</div>
                    </div>
                    <div class="text-center-y cursor-pointer">
                      <div class="title-name mr-10">{{eq.zone}}</div>
                      <div class="text-center-y attribute mr-10 text-table-col">{{eq.zone_desc}}</div>
                    </div>
                    <div class="cursor-pointer">
                      <div class="title-name mr-10">{{eq.system.split(' ')[0].replace('.', '')}}</div>
                      <div
                        class="text-center-y attribute mr-10 text-table-col"> {{eq.system.split(' ').splice(1).join(' ')}}</div>
                    </div>
                    <div class="text-center-y space-between">
                      <div class="df mr-5">
                        <div class="coordinates-x cxy">X:</div>
                        <span class="mm-text cxy">{{' ' + round(eq.x)}}</span>
                      </div>
                      <div class="df mr-5">
                        <div class="coordinates-y cxy">Y:</div>
                        <span class="mm-text cxy">{{' ' + round(eq.y)}}</span>
                      </div>
                      <div class="df mr-5">
                        <div class="coordinates-z cxy">Z:</div>
                        <span class="mm-text cxy">{{' ' + round(eq.z)}}</span>
                      </div>
                      <div class="p-ml-auto text-center-y">
                        <div class="df">
                          <div class="trm">{{eq.stock_code}}</div>
                          <div (click)="copyTrmCode(eq.stock_code, 'e' + e)" class="trm-copy cursor-pointer cxy">
                            <img src="assets/icons/trm.svg" height="16">
                            <div class="copy-tooltip" [hidden]="!showTooltip('e' + e)">Copied!</div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="w-75 right-content-card mt-20">
          <div class="df tabs-header">
            <div class="all-tabs cursor-pointer" (click)="equipmentHeadTab = 'Info'"
                 [class.selectedTab]="equipmentHeadTab ==  'Info'">{{l.tr('Информация')}}</div>
            <div class="all-tabs cursor-pointer" (click)="equipmentHeadTab = 'Cables'"
                 [class.selectedTab]="equipmentHeadTab ==  'Cables'">{{l.tr('Кабели')}}</div>
            <div class="all-tabs cursor-pointer" (click)="equipmentHeadTab = '3D'"
                 [class.selectedTab]="equipmentHeadTab ==  '3D'">{{l.tr('3D')}}</div>
          </div>
          <div [hidden]="equipmentHeadTab != 'Info'" class="card-tabs">
            <div *ngIf="selectedEq == null">
              Please select the equipment
            </div>
            <div *ngIf="eqCpSource.length == 0 && selectedEq != null">
              No result INFO for this equipment
            </div>
            <div *ngIf="eqCpSource.length != 0">
              <div class="top-row-equip">
                <div class="text-center-y">
                  <div class="title-medium-bold">{{eqCpSource[0].workShopMaterial.name}} {{eqCpSource[0].workShopMaterial.description}}</div>
                </div>
              </div>
            </div>
          </div>
          <div [hidden]="equipmentHeadTab != 'Cables'" class="card-tabs">
            <div *ngIf="selectedEq == null">
              Please select the equipment
            </div>
            <div *ngIf="selectedEq != null">
              <div class="tile">
                <div class="w-100" *ngIf="equipmentCables.length != 0">
                  <div *ngFor="let cable of equipmentCables; let i = index"
                       [class.hidden-card]="cable == null">
                    <div class="card-tile-t w-100"
                         [class.hidden-card]="cable == null">
                      <div class="top-row df">
                        <div [ngSwitch]="cable.f_rout" class="cxy mr-1">
                          <div *ngSwitchCase="0" class="point red-point" pTooltip="{{l.tr('Не проложен')}}"
                               tooltipPosition="top"></div>
                          <div *ngSwitchCase="1" class="point green-point" pTooltip="{{l.tr('Проложен')}}"
                               tooltipPosition="top"></div>
                          <div *ngSwitchCase="2" class="point yellow-point" pTooltip="{{l.tr('Проложен частично')}}"
                               tooltipPosition="top"></div>
                        </div>
                        <div class="cxy mr-1" *ngIf="cable.bunch != ''" pTooltip="{{l.tr('Пучковая прокладка')}}"
                             tooltipPosition="top">
                          <img src="assets/icons/hub.png" height="18">
                        </div>
                        <div class="cxy mr-2">
                          <div class="title-medium-bold">{{cable.code}}</div>
                        </div>
                        <div class="cxy mr-2">
                          <div class=title-name>{{cable.description}}</div>
                        </div>
                        <div class="df cxy mr-1">
                          <div class="text-center-y attribute mr-10 title-name">Sec:</div>
                          <div class="title-name">{{cable.nom_section}}</div>
                        </div>
                        <div class="df cxy mr-1">
                          <div class="text-center-y attribute mr-10 title-name">D:</div>
                          <div class="title-name">{{cable.diameter}}</div>
                        </div>
                        <div class="df cxy mr-1">
                          <div class="text-center-y attribute mr-10 title-name">Seg:</div>
                          <div class="title-name">{{cable.seg_code}}</div>
                        </div>
                        <div class="df cxy mr-1">
                          <div class="text-center-y attribute mr-10 title-name">L:</div>
                          <div class="title-name">{{round(cable.length) + 'm'}}</div>
                          <div
                            class="text-center-y attribute mr-10 title-name" pTooltip="{{l.tr('Поправка длины')}}"
                            tooltipPosition="right">
                            {{' (' + cable.ext_len_1 + '-' + cable.ext_len_2 + ')'}}</div>
                        </div>
                        <div class="p-ml-auto text-center-y">
                          <div class="df">
                            <div class="trm">{{cable.stock_code}}</div>
                            <div (click)="copyTrmCode(cable.stock_code, 'c' + i)" class="trm-copy cursor-pointer cxy">
                              <img src="assets/icons/trm.svg" height="16">
                              <div class="copy-tooltip" [hidden]="!showTooltip('c' + i)">Copied!</div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="route mb-5">
                        <!--                        <div  *ngIf="cable.cab_route_area.length != 0">-->
                        <!--                          {{cable.cab_route_area.join('<->')}}-->
                        <!--                        </div>-->
                        <!--                        <div class="df space-between" *ngIf="cable.cab_route_area.length != 0">-->
                        <!--                          <div *ngFor="let node of cable.cab_route_area; let e = index"-->
                        <!--                               [class.hidden-card]="node == null">-->
                        <!--                            <div class="node gray-point" pTooltip="{{node}}"-->
                        <!--                                 tooltipPosition="top"></div>-->
                        <!--                          </div>-->
                        <!--                        </div>-->
                        <div class="df nodeRoute" *ngIf="cable.cab_route_area.length != 0">
                          {{cable.cab_route_area.join('<->')}}
                        </div>
                      </div>
                      <div class="bottom-grid mr-1">

                        <div class="hover-row cursor-pointer" (click)="onClickFromEquipment(cable)">
                          <div class="mb-5 equip-style">
                            <div class="df flex-end">
                              <div class="attribute text-table-col flex-end mr-10"
                                   *ngIf="cable.from_eq_desc != ''">{{cable.from_eq_desc}}</div>
                              <div class="attribute mr-10 text-table-col" *ngIf="cable.from_eq_id != ''">
                                ({{cable.from_eq_id}})
                              </div>
                              <div class="title-name flex-end" *ngIf="cable.from_eq != ''">{{cable.from_eq}}</div>
                            </div>
                          </div>
                          <div class="mb-5 zone-style df flex-end">
                            <div class="attribute text-table-col mr-10"
                                 *ngIf="cable.from_zone_desc != ''">{{cable.from_zone_desc}}</div>
                            <div class="title-name"
                                 *ngIf="cable.from_zone != ''">{{cable.from_zone}}</div>
                          </div>
                          <div class="flex-end system-style">
                            <div
                              class="title-name" *ngIf="cable.from_system != ''"
                              pTooltip="{{cable.from_system.split(' ').splice(1).join(' ')}}"
                              tooltipPosition="left">
                              {{cable.from_system.split(' ')[0].replace('.', '')}}
                            </div>
                          </div>
                        </div>
                        <div>
                          <div class="df coordinates-row cxy mb-1r">
                            <span class="mm-text flex-end">{{' ' + round(cable.from_x)}}</span>
                            <div class="coordinates-x cxy mr-5 ml-5">X</div>
                            <span class="mm-text flex-start">{{' ' + round(cable.to_x)}}</span>
                          </div>
                          <div class="df coordinates-row cxy mb-1r">
                            <span class="mm-text flex-end">{{' ' + round(cable.from_y)}}</span>
                            <div class="coordinates-y cxy mr-5 ml-5">Y</div>
                            <span class="mm-text flex-start">{{' ' + round(cable.to_y)}}</span>
                          </div>
                          <div class="df coordinates-row cxy mb-1r">
                            <span class="mm-text flex-end">{{' ' + round(cable.from_z)}}</span>
                            <div class="coordinates-z cxy mr-5 ml-5">Z</div>
                            <span class="mm-text flex-start">{{' ' + round(cable.to_z)}}</span>
                          </div>
                        </div>
                        <div class="cursor-pointer hover-row" (click)="onClickToEquipment(cable)">
                          <div class="mb-5 equip-style">
                            <div class="df">
                              <div class="title-name mr-10" *ngIf="cable.to_eq != ''">{{cable.to_eq}}</div>
                              <div class="attribute text-table-col mr-10" *ngIf="cable.to_eq_id != ''">
                                ({{cable.to_eq_id}})
                              </div>
                              <div class="attribute text-table-col"
                                   *ngIf="cable.to_eq_desc != ''">{{cable.to_eq_desc}}</div>
                            </div>
                          </div>
                          <div class="mb-5 zone-style df ">
                            <div class="title-name mr-10" *ngIf="cable.to_zone != ''">{{cable.to_zone}}</div>
                            <div class="attribute text-table-col "
                                 *ngIf="cable.to_zone_desc != ''">{{cable.to_zone_desc}}</div>
                          </div>
                          <div *ngIf="cable.to_system != ''" class="system-style">
                            <div class="flex-start">
                              <div
                                class="title-name"
                                pTooltip="{{cable.to_system.split(' ').splice(1).join(' ')}}"
                                tooltipPosition="right">
                                {{cable.to_system.split(' ')[0].replace('.', '')}}
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div [hidden]="equipmentHeadTab != '3D'" class="card-tabs">
            <div *ngIf="selectedEq == null">
              Please select the equipment
            </div>
            <iframe class="w-100 h-100" *ngIf="selectedEq != null" [src]="urlSafe"></iframe>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

