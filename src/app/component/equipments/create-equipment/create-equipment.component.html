
<form [formGroup]="equipmentForm" class="form-container">
  <div class="big-text-create mb-1">{{t.tr('Проект')}}</div>
  <p-dropdown formControlName="project" class="select"  [options]="equipmentProjects" appendTo = "body" styleClass="width-300 font-13"></p-dropdown>
  <div class="big-text-create mb-1">{{t.tr('Отдел')}}</div>
  <p-dropdown formControlName="department" class="select" [options]="equipmentDepartments" appendTo = "body" styleClass="width-300 font-13"></p-dropdown>
  <div class="big-text-create mb-1">{{'SFI'}}</div>
  <p-dropdown formControlName="sfi" class="select" optionLabel="code" optionValue="code" placeholder="SFI number" [options]="sfis" appendTo = "body" styleClass="width-300 font-13" [filter]="true" filterBy="code,ru,en">
    <ng-template let-sfi pTemplate="item">
      <div class="df user-select">
        <div >{{sfi.code}}</div>
        <div >{{sfi.ru}}</div>
        <div >{{sfi.eng}}</div>
      </div>
    </ng-template>
  </p-dropdown>

  <label for="name">{{t.tr('Наименование')}} </label>
  <input pInputText id="name" type="text" formControlName="name">


  <label for="description">{{t.tr('Описание')}} </label>
  <input pInputText id="description" type="text" formControlName="description">

  <label for="commentText">{{t.tr('Комментарий')}} </label>
  <input pInputText id="commentText" type="text" formControlName="commentText">

<!--  добавление файла в момент создания нового оборудования-->
  <div class="mt-1" *ngIf="equipmentFiles.length != 0">Вложения</div>
  <p-table class="files_table table" [value]="equipmentFiles" styleClass="p-datatable-striped" [tableStyle]="{'min-width': '50rem'}">
    <ng-template pTemplate="body" let-file>
      <tr>
        <td>
          <div class="cxy">
            <img [src]="'assets/task/' + getFileExtensionIcon(file.url)" height="16"/>
            <span class="file-name-esp mx-10 cy">{{trimFileName(file.url, 22) + ' '}}</span>
          </div>
        </td>
        <td>REV{{file.rev}}</td>
        <td>{{this.auth.getUserNameById(file.user_id)}}</td>
        <td>{{this.getDateOnly(file.create_date)}}</td>
        <td><a class="p-link" (click)="downloadFile(file.url)" target="_blank">{{ t.tr('Скачать') }}</a></td>
        <td>
          <div (click)="deleteFile(file)">
            <svg class="icon-nest delete-button" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24">
              <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/>
            </svg>
          </div>
        </td>
      </tr>
    </ng-template>
  </p-table>


</form>

<div class="mr-5 mt-20 cx">
  <div tabindex="10"  [class.disabled-button]="!equipmentForm.valid" (click)="addFiles()" class="button-ok ml-1">{{t.tr('Добавить файлы')}}</div>
</div>
<div class="mr-5 mt-20 cx">
<!--  <div tabindex="10" [class.disabled-button]="!equipmentForm.valid  && (equipmentForm.get('project')?.value == '-')" (click)="createEquipment()" class="button-ok cxy">{{t.tr('Создать')}}</div>-->
<!--  <div tabindex="10" (click)="close()" pButton [label]="t.tr('Отмена')" class="button-cancel ml-1"></div>-->

  <button tabindex="10" [class.disabled-button]="!equipmentForm.valid" (click)="createEquipment()" class="button-ok cxy">{{t.tr('Создать')}}</button>
  <div tabindex="10" (click)="close()" pButton [label]="t.tr('Отмена')" class="button-cancel ml-1"></div>
<!--      <div tabindex="10" [class.disabled-button]="!equipmentForm.valid && !equipmentForm.get('project')?.touched && (equipmentForm.get('project')?.value == '-')" (click)="createEquipment()" class="button-ok cxy">{{t.tr('Создать')}}</div>-->
<!--      <div tabindex="10" (click)="close()" pButton [label]="t.tr('Отмена')" class="button-cancel ml-1"></div>-->
</div>
<!--<hr>-->

<!--<p>Form Value: {{ equipmentForm.value | json }}</p>-->

<!--<p>Form Status: {{ equipmentForm.status }}</p>-->
