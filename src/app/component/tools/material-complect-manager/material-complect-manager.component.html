<div class="page">
  <div class="complects">
    <div class="select-project df cx">
      <div class="big-text-card mb-1 cxy mx-10">Проект</div>
      <div class="mx-10">
        <p-dropdown class="select" [(ngModel)]="project" [options]="projects" (ngModelChange)="projectChanged()" styleClass="width-156 font-14">
        </p-dropdown>
      </div>
      <button (click)="addComplect()">ДОБАВИТЬ КОМПЛЕКТ</button>
    </div>
    <cdk-virtual-scroll-viewport class="background-gray" style="height: 81vh" [itemSize]="40">
      <div [style.height]="40 + 'px'" class="issues-all" *cdkVirtualFor="let compl of complects">
        <div class="complect cursor-pointer" [class.selected-complect]="selectedComplect == compl" (click)="selectComplect(compl)">
          <div class="complect-header">
            <div>{{compl.name}} {{getComplectLength(compl)}}</div>
            <div class="complect-project">{{compl.project}}</div>
            <div (click)="deleteComplect(compl)">
              DEL
            </div>
          </div>
        </div>
      </div>
    </cdk-virtual-scroll-viewport>
  </div>
  <div>

    <p-table [value]="materials" [scrollable]="true" [virtualScroll]="true" [virtualRowHeight]="20" [scrollHeight]="'76vh'" [styleClass]="'p-datatable-sm'" [(selection)]="selectedMaterials" [globalFilterFields]="['name', 'code']" #materialsTable>
      <ng-template pTemplate="caption">
        <div class="flex">
              <span class="p-input-icon-left ml-auto">
                <i class="pi pi-search"></i>
                <input #searchMaterials pInputText type="text" (input)="materialsTable.filterGlobal(searchMaterials.value, 'contains')" placeholder="Поиск" />
            </span>
        </div>
      </ng-template>
      <ng-template pTemplate="header">
        <tr>
          <th style="min-width: 50px; max-width: 50px">
            <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
          </th>
          <th style="min-width: 450px">Name</th>
          <th style="min-width: 150px">Code</th>
          <th style="min-width: 50px">Units</th>
          <th style="min-width: 50px">Weight</th>
          <th>Count</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-material>
        <tr>
          <td style="min-width: 50px; max-width: 50px">
            <p-tableCheckbox [value]="material"></p-tableCheckbox>
          </td>
          <td style="min-width: 450px">{{material.name}}</td>
          <td style="min-width: 150px">{{material.code}}</td>
          <td style="min-width: 50px">{{material.units}}</td>
          <td style="min-width: 50px">{{material.singleWeight}}</td>
          <td><p-inputNumber [mode]="'decimal'" [(ngModel)]="material.count" [minFractionDigits]="2"></p-inputNumber></td>
        </tr>
      </ng-template>
    </p-table>
    <button (click)="save()">СОХРАНИТЬ ИЗМЕНЕНИЯ</button>
  </div>
</div>
